/**
 * Created by johnny on 2017/1/23.
 */
var sqlite3 = module.exports = exports = require('sqlite3').verbose();

function posts() {
}

function isContains(str, substr) {
    return str.indexOf(substr) >= 0;
}

posts.getRows = function(dbFile, callback) {
    var db = new sqlite3.Database(dbFile);
    db.all("select * from posts", function(err, rows) {
        if(err) {
            console.error(err);
        }
        callback(rows);
    })
}

posts.getRow = function(dbFile, callback){
    var db = new sqlite3.Database(dbFile);
    db.each("select * from posts", function(err, row) {
        if (err) {
            console.error(err);
        }
        callback(row);
    });
}

function getPicture(row) {
    var markdown = row.markdown;
    if(markdown.includes('![')) {
        var re = /\!\[(.*)\]\((.*)\)/g;
        console.log(re.exec(markdown));
    }
    else {
        console.log('there is not any pictures');
    }
}

posts.getPictures = function(dbFile) {
    var db = new sqlite3.Database(dbFile);
    db.each("select * from posts", function(err, row) {
        if (err) {
            console.error(err);
        }
        getPicture(row);
    })
}

module.exports = posts;